<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Reaction Time Test â€“ How Fast Are You?</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta name="description" content="Test your reaction speed. Tap when the screen turns green. Play 3 rounds to get your accurate reaction time." />

<style>
html, body {
  margin: 0;
  padding: 0;
  height: 100%;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
  background: #8b0000;
  color: #fff;
  text-align: center;
  user-select: none;
}

body.go { background: #0a8f08; }

.container {
  height: 100%;
  display: flex;
  flex-direction: column;
  justify-content: space-between;
  align-items: center;
  padding: 16px;
}

#character {
  width: 220px;
  max-width: 60%;
  margin-top: 20px;
}

/* ===== CAT ANIMATIONS ===== */
.idle {
  animation: breathe 3s ease-in-out infinite;
}

.waiting {
  animation: wiggle 0.6s ease-in-out infinite;
}

.react {
  animation: pop 0.35s ease-out;
}

@keyframes breathe {
  0%,100% { transform: scale(1); }
  50% { transform: scale(1.04); }
}

@keyframes wiggle {
  0% { transform: rotate(0deg); }
  25% { transform: rotate(-2deg); }
  50% { transform: rotate(2deg); }
  75% { transform: rotate(-1deg); }
  100% { transform: rotate(0deg); }
}

@keyframes pop {
  0% { transform: scale(0.9); }
  60% { transform: scale(1.15); }
  100% { transform: scale(1); }
}

/* ===== TEXT ===== */
#main {
  font-size: 28px;
  font-weight: 700;
  margin-top: 10px;
}

#sub {
  font-size: 16px;
  opacity: 0.9;
  white-space: pre-line;
}

/* ===== SHARE ===== */
#shareBtn {
  display: none;
  padding: 12px 18px;
  border-radius: 10px;
  border: none;
  font-size: 16px;
  font_toggle: 600;
  background: #fff;
  color: #000;
  cursor: pointer;
}

/* ===== AD SAFE PLACEHOLDER ===== */
#ad {
  width: 100%;
  max-width: 360px;
  height: 90px;
  margin-bottom: 10px;
  background: rgba(0,0,0,0.2);
  border-radius: 8px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 14px;
  opacity: 0.7;
}
</style>
</head>

<body class="ready">
<div class="container" id="game">

  <img id="character" src="cat-idle.png" class="idle" alt="Reaction Cat" />

  <div id="main">Tap to start</div>
  <div id="sub">To get your exact reaction time, play 3 rounds.</div>

  <button id="shareBtn">Share your score</button>

  <div id="ad">Ad Space</div>
</div>

<script>
let startTime = 0;
let timeout = null;
let attempts = [];
let state = "ready";

const main = document.getElementById("main");
const sub = document.getElementById("sub");
const character = document.getElementById("character");
const shareBtn = document.getElementById("shareBtn");

function setCat(img, cls) {
  character.src = img;
  character.className = cls;
}

function getGrade(ms) {
  if (ms < 180) return { grade: "S", img: "cat-happy.png", text: "Lightning fast âš¡" };
  if (ms < 230) return { grade: "A", img: "cat-fast.png", text: "Excellent!" };
  if (ms < 300) return { grade: "B", img: "cat-ready.png", text: "Good reaction" };
  if (ms < 380) return { grade: "C", img: "cat-idle.png", text: "Average" };
  return { grade: "D", img: "cat-slow.png", text: "Too slow ðŸ˜µâ€ðŸ’«" };
}

function getPercentile(ms) {
  if (ms < 180) return "Top 1%";
  if (ms < 220) return "Top 5%";
  if (ms < 260) return "Top 15%";
  if (ms < 320) return "Top 35%";
  return "Below average";
}

document.body.addEventListener("click", () => {
  if (state === "ready") {
    state = "waiting";
    main.innerText = "Wait for GREENâ€¦";
    sub.innerText = "";
    document.body.className = "waiting";
    setCat("cat-ready.png", "waiting");

    timeout = setTimeout(() => {
      state = "go";
      startTime = Date.now();
      main.innerText = "TAP!";
      document.body.className = "go";
    }, Math.random() * 2000 + 1000);
  }

  else if (state === "waiting") {
    clearTimeout(timeout);
    state = "ready";
    main.innerText = "Too soon!";
    sub.innerText = "Tap to try again";
    document.body.className = "ready";
    setCat("cat-slow.png", "react");
  }

  else if (state === "go") {
    const reaction = Date.now() - startTime;
    attempts.push(reaction);

    const result = getGrade(reaction);
    setCat(result.img, "react");

    main.innerText = `Reaction: ${reaction} ms`;
    sub.innerText = `Grade: ${result.grade} â€” ${result.text}`;

    document.body.className = "ready";
    state = "ready";

    if (attempts.length >= 3) {
      const best = Math.min(...attempts);
      const percentile = getPercentile(best);

      sub.innerText += `\nBest of 3: ${best} ms\nYou are ${percentile}`;
      shareBtn.style.display = "inline-block";

      shareBtn.onclick = () => {
        navigator.share?.({
          text: `My reaction time is ${best} ms (${percentile}) âš¡ Try it!`
        });
      };

      attempts = [];
    }
  }
});
</script>
</body>
</html>